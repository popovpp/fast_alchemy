FROM python:3.8.5
ENV PYTHONUNBUFFERED 1
RUN mkdir /code
WORKDIR /code
COPY requirements.txt /code/
RUN pip3 install -r requirements.txt
COPY . /code/

ENV PYTHONDONTWRITEBYTECODE=1
WORKDIR /code/app

RUN poetry update

WORKDIR /code/accounts

RUN poetry update

# Postgres
ARG API_PG_DB=""
ARG API_PG_USER=""
ARG API_PG_PASSWORD=""
ARG API_PG_HOST=localhost
ARG API_PG_PORT=5432

ENV API_PG_DB=$API_PG_DB
ENV API_PG_USER=$API_PG_USER
ENV API_PG_PASSWORD=$API_PG_PASSWORD
ENV API_PG_HOST=$API_PG_HOST
ENV API_PG_PORT=$API_PG_PORT


ENV PYTHONPATH "${PYTHONPATH}:/code"
